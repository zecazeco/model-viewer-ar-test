<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AR direto</title>

    <!-- model-viewer -->
    <script type="module" src="https://unpkg.com/@google/model-viewer@4.1.0/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer@4.1.0/dist/model-viewer-legacy.js"></script>

    <style>
      html, body { height: 100%; margin: 0; background: #f6f7f9; }
      model-viewer { width: 100%; height: 100%; }
      #ar-prompt {
        position: absolute; left: 50%; bottom: 100px;
        transform: translateX(-50%);
        display: none;
        font: 500 14px system-ui;
        background: rgba(0,0,0,.6); color: white;
        padding: 6px 12px; border-radius: 8px;
      }
      model-viewer[ar-status="session-started"] #ar-prompt { display: block; }
    </style>
  </head>

  <body>
    <model-viewer
      id="mv"
      src="teste.glb"
      ios-src="teste.usdz"
      alt="Modelo 3D de teste"
      ar
      ar-modes="webxr scene-viewer quick-look"
      ar-placement="floor"
      autoplay
      shadow-intensity="1"
      exposure="1">
      <div id="ar-prompt">Mova o telefone para encontrar o plano…</div>
    </model-viewer>

    <script>
      const mv = document.getElementById('mv');

      // Assim que o modelo carregar, já tenta entrar em AR
      mv.addEventListener('load', () => {
        // O método launchAR() só funciona em dispositivos compatíveis
        if (mv.canActivateAR) {
          mv.activateAR();
        } else {
          console.warn("AR não é suportado neste dispositivo/navegador.");
        }
      });

      // Logs úteis
      mv.addEventListener('ar-status', () =>
        console.log('ar-status:', mv.arStatus)
      );
      mv.addEventListener('error', (e) =>
        console.error('model-viewer error:', e)
      );
    </script>
  </body>
</html>
