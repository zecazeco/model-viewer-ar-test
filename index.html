<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AR com <model-viewer></title>

    <!-- Carrega o web component (versão estável) -->
    <script type="module" src="https://unpkg.com/@google/model-viewer@4.1.0/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer@4.1.0/dist/model-viewer-legacy.js"></script>
    <!-- ↑ Necessário. Sem isso o custom element não funciona. :contentReference[oaicite:1]{index=1} -->

    <style>
      html, body { height: 100%; margin: 0; }
      model-viewer { width: 100%; height: 100%; min-height: 80vh; background: #f6f7f9; }
      /* Botão custom de AR (aparece só em device compatível) */
      [slot="ar-button"] {
        position: absolute; right: 16px; bottom: 16px;
        padding: 12px 16px; border: 0; border-radius: 999px;
        font: 600 14px/1 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
        box-shadow: 0 4px 12px rgba(0,0,0,.15); cursor: pointer;
      }
      /* Dica enquanto o AR está procurando o plano */
      #ar-prompt { position: absolute; left: 50%; bottom: 100px; transform: translateX(-50%); display: none; }
      model-viewer[ar-status="session-started"] #ar-prompt { display: block; }
    </style>
  </head>

  <body>
    <model-viewer
      id="mv"
      src="teste.glb"
      ios-src="https://modelviewer.dev/shared-assets/models/Astronaut.usdz"
      alt="Modelo 3D de um astronauta"
      ar
      ar-modes="webxr scene-viewer quick-look"
      ar-placement="floor"       
      xr-environment            
      camera-controls
      touch-action="pan-y"
      shadow-intensity="1"
      exposure="1"
      autoplay>
      <button slot="ar-button">Ver em AR</button>
      <div id="ar-prompt">Mova o telefone para encontrar o plano…</div>
    </model-viewer>

    <script>
      // Logs úteis para diagnosticar
      const mv = document.getElementById('mv');
      mv.addEventListener('ar-status', () => console.log('ar-status:', mv.arStatus));
      mv.addEventListener('error', (e) => console.error('model-viewer error:', e));
    </script>
  </body>
</html>
